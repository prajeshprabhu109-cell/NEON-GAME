<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Neon Darts</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            background: #0d0d1e;
            color: #00f0ff;
            font-family: 'Roboto Mono', monospace;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            min-height: 100vh;
            margin: 0;
            padding: 10px 0;
            overflow-x: hidden;
        }
        #board-frame {
            width: 330px;
            height: 330px;
            border-radius: 50%;
            border: 8px solid #ff007f;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 30px rgba(255, 0, 127, 0.8);
            position: relative;
            background: #000;
            margin-top: 5px;
        }
        #board {
            width: 310px;
            height: 310px;
            border-radius: 50%;
            position: relative;
            background-image: url('dart.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            overflow: hidden;
        }
        #crosshair {
            width: 28px;
            height: 28px;
            border: 2px solid #fff;
            position: absolute;
            border-radius: 50%;
            pointer-events: none;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 10px #fff;
            z-index: 10;
        }
        .btn-throw {
            background: #ff007f;
            color: white;
            padding: 10px 35px;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 25px;
            box-shadow: 0 4px #b8005b;
            transition: all 0.1s;
            text-transform: uppercase;
        }
        .btn-throw:active { transform: translateY(2px); box-shadow: 0 2px #b8005b; }

        #muteToggle {
            cursor: pointer;
            color: #ff007f;
            text-decoration: underline;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .instructions {
            max-width: 400px;
            background: rgba(26, 26, 46, 0.8);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #333;
            margin: 20px 0;
            text-align: center;
        }
    </style>
</head>
<body onclick="startMusicOnce()">

    <div class="mb-4 text-center">
        <h1 class="text-3xl font-bold mb-2 text-cyan-400 text-shadow-glow">NEON DARTS</h1>
        <div class="text-xl text-yellow-400 mb-1">BET: $100 | WIN: UP TO $1000</div>
        <div class="flex justify-center gap-6 items-center">
            <div class="text-sm text-green-400 font-bold">YOUR CASH: $<span id="balanceDisplay">0</span></div>
            <div id="muteToggle" onclick="toggleMute(event)">üîà MUTE MUSIC</div>
        </div>
    </div>

    <audio id="bgMusic" loop>
        <source src="music2 (1).mp4" type="audio/mpeg">
        <source src="music2 (1).mp4" type="video/mp4">
    </audio>

    <canvas id="colorScanner" width="310" height="310" style="display:none;"></canvas>

    <div id="board-frame">
        <div id="board">
            <div id="crosshair"></div>
        </div>
    </div>

    <button class="btn-throw text-lg" onclick="throwDart()">THROW DART</button>

    <div id="msg" class="mt-4 h-8 text-xl font-bold"></div>

    <div class="instructions text-xs">
        <p class="text-cyan-400 font-bold mb-1 underline">HOW TO PLAY:</p>
        <p>Wait for the moving crosshair to align with a high-value zone, then hit <b>THROW</b>. Aim for the center Bullseye for the $1000 Jackpot!</p>
    </div>

    <a href="clubs.html" class="mb-4 text-gray-500 hover:text-cyan-400 transition-colors">‚Üê Back to Clubs</a>

    <script>
        const crosshair = document.getElementById('crosshair');
        const board = document.getElementById('board');
        const msg = document.getElementById('msg');
        const balanceDisplay = document.getElementById('balanceDisplay');
        const scannerCanvas = document.getElementById('colorScanner');
        const sCtx = scannerCanvas.getContext('2d', { willReadFrequently: true });
        const music = document.getElementById('bgMusic');
        const muteToggle = document.getElementById('muteToggle');

        let posX = 155, posY = 155, angle = 0;
        let isMoving = true;
        let musicStarted = false;
        let isMuted = false;
        let boardImg = new Image();
        boardImg.src = 'dart.png';

        window.onload = function() {
            if (localStorage.getItem('currentPlayerCash') === null) {
                localStorage.setItem('currentPlayerCash', '5000');
            }
            updateUI();
            moveCrosshair();
            music.volume = 0.4;
            boardImg.onload = () => sCtx.drawImage(boardImg, 0, 0, 310, 310);
        };

        function startMusicOnce() {
            if (!musicStarted && !isMuted) {
                music.play().then(() => {
                    musicStarted = true;
                }).catch(err => console.log("Audio waiting for interaction..."));
            }
        }

        // Functional Mute Toggle
        function toggleMute(event) {
            event.stopPropagation(); // Prevents startMusicOnce from firing immediately
            isMuted = !isMuted;
            if (isMuted) {
                music.pause();
                muteToggle.innerText = "üîä UNMUTE MUSIC";
            } else {
                music.play();
                muteToggle.innerText = "üîà MUTE MUSIC";
                musicStarted = true;
            }
        }

        function updateUI() {
            balanceDisplay.innerText = localStorage.getItem('currentPlayerCash') || 0;
        }

        function moveCrosshair() {
            if (!isMoving) return;
            angle += 0.045;
            posX = 155 + Math.cos(angle * 1.3) * 125;
            posY = 155 + Math.sin(angle * 0.8) * 125;
            crosshair.style.left = posX + 'px';
            crosshair.style.top = posY + 'px';
            requestAnimationFrame(moveCrosshair);
        }

        function throwDart() {
            if (!isMoving) return;

            let cash = parseInt(localStorage.getItem('currentPlayerCash')) || 0;
            if (cash < 100) {
                alert("Need $100 to play!");
                return;
            }

            isMoving = false;
            cash -= 100;
            sCtx.drawImage(boardImg, 0, 0, 310, 310);
            const pixel = sCtx.getImageData(Math.floor(posX), Math.floor(posY), 1, 1).data;
            const r = pixel[0], g = pixel[1];
            const dist = Math.sqrt(Math.pow(posX - 155, 2) + Math.pow(posY - 155, 2));

            if (dist < 12) {
                msg.innerText = "üéØ MASTER HUSTLER! +$1000";
                msg.style.color = "#FFD700";
                cash += 1000;
            } else if (r > 150 && g < 100) {
                msg.innerText = "RED ZONE! +$400";
                msg.style.color = "#ff4444";
                cash += 400;
            } else if (g > 100 && r < 100) {
                msg.innerText = "GREEN ZONE! +$250";
                msg.style.color = "#4ade80";
                cash += 250;
            } else if (dist < 150) {
                msg.innerText = "BOARD HIT! +$50";
                msg.style.color = "#22d3ee";
                cash += 50;
            } else {
                msg.innerText = "TOTAL MISS!";
                msg.style.color = "#888";
            }

            localStorage.setItem('currentPlayerCash', cash);
            updateUI();
            setTimeout(() => {
                msg.innerText = "";
                isMoving = true;
                moveCrosshair();
            }, 1500);
        }
    </script>
</body>
</html>