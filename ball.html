<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Neon Hustle: 8-Ball Pool Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            background-color: #0d0d1e;
            color: #00f0ff;
            font-family: 'Roboto Mono', monospace;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            min-height: 100vh;
            margin: 0;
            padding: 20px 0;
            overflow-x: hidden;
        }

        #powerMeter {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            width: 25px;
            height: 200px;
            background: #111;
            border: 2px solid #333;
            display: flex;
            flex-direction: column-reverse;
            border-radius: 5px;
            z-index: 10;
        }

        .power-segment { width: 100%; height: 25%; opacity: 0.1; transition: opacity 0.05s; }
        .p-red { background: #ff0000; box-shadow: 0 0 10px #ff0000; }
        .p-orange { background: #ffa500; box-shadow: 0 0 10px #ffa500; }
        .p-yellow { background: #ffff00; box-shadow: 0 0 10px #ffff00; }
        .p-green { background: #00ff00; box-shadow: 0 0 10px #00ff00; }

        #poolTableContainer {
            position: relative;
            padding: 15px;
            background: #1a1a2e;
            border: 6px solid #333;
            border-radius: 15px;
            margin: 20px 0;
        }

        canvas {
            background: radial-gradient(circle, #0a4d34 0%, #031a11 100%);
            border: 3px solid #111;
            border-radius: 8px;
            cursor: crosshair;
        }

        .btn-action {
            background-color: #ff007f;
            color: white;
            font-weight: bold;
            padding: 12px 35px;
            border-radius: 8px;
            text-transform: uppercase;
            cursor: pointer;
            border: none;
            box-shadow: 0 4px #b8005b;
        }

        #muteToggle {
            cursor: pointer;
            color: #ff007f;
            text-decoration: underline;
            font-weight: bold;
        }

        .instructions {
            max-width: 600px;
            background: rgba(26, 26, 46, 0.8);
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #333;
            margin-top: 20px;
        }
    </style>
</head>
<body>

    <video id="bgMusic" loop playsinline style="display:none;">
        <source src="music5 (1).mp4" type="video/mp4">
    </video>

    <div class="text-center">
        <h1 class="text-3xl font-bold text-cyan-400 mb-2">NEON POOL PRO</h1>
        <div class="flex justify-center gap-6 items-center">
            <div class="text-green-400 font-bold text-xl">CASH: $<span id="balanceDisplay">5000</span></div>
            <div id="muteToggle" onclick="toggleMusic()">üîà MUTE MUSIC</div>
        </div>
    </div>

    <div id="poolTableContainer">
        <div id="powerMeter">
            <div id="seg-red" class="power-segment p-red"></div>
            <div id="seg-orange" class="power-segment p-orange"></div>
            <div id="seg-yellow" class="power-segment p-yellow"></div>
            <div id="seg-green" class="power-segment p-green"></div>
        </div>
        <canvas id="poolCanvas" width="680" height="340"></canvas>
    </div>

    <a href="clubs.html" class="text-gray-500 hover:text-cyan-400 font-bold text-sm">‚Üê BACK TO CLUBS</a>

    <button class="btn-action" onclick="resetTable()">RESET TABLE ($200)</button>

        <div class="instructions text-sm">
        <h3 class="text-cyan-400 font-bold mb-2 underline">HOW TO PLAY:</h3>
        <p>‚Ä¢ <b class="text-pink-500">Aim:</b> Move your mouse to rotate the cue stick.</p>
        <p>‚Ä¢ <b class="text-pink-500">Power:</b> Click & hold, then pull back from the white ball.</p>
        <p>‚Ä¢ <b class="text-pink-500">Shoot:</b> Release the mouse button to strike.</p>
        <p>‚Ä¢ <b class="text-pink-500">Rules:</b> Sink all colored balls. The stick returns only when balls stop.</p>
    </div>

    <div class="instructions text-sm">
        <h3 class="text-cyan-400 font-bold mb-2 underline">REWARDS:</h3>
        <p>‚Ä¢ <span class="text-green-400 font-bold">+$500</span> for every colored ball pocketed.</p>
        <p>‚Ä¢ <span class="text-red-500 font-bold">-$200</span> penalty if the white ball falls.</p>
    </div>

    <script>
        const canvas = document.getElementById('poolCanvas');
        const ctx = canvas.getContext('2d');
        const balanceDisplay = document.getElementById('balanceDisplay');
        const music = document.getElementById('bgMusic');
        const muteToggle = document.getElementById('muteToggle');

        let balls = [];
        let floatingTexts = [];
        let cueBall;
        let isDragging = false;
        let mousePos = { x: 0, y: 0 };
        let power = 0;
        let isMuted = false;

        const FRICTION = 0.985;
        const BALL_RADIUS = 10;
        const MIN_VELOCITY = 0.15;
        const POCKET_RADIUS = 30;

        const pockets = [
            {x: 0, y: 0}, {x: 340, y: 0}, {x: 680, y: 0},
            {x: 0, y: 340}, {x: 340, y: 340}, {x: 680, y: 340}
        ];

        function updateCash(amount) {
            let current = parseInt(balanceDisplay.innerText);
            balanceDisplay.innerText = current + amount;
        }

        function createFloatingText(x, y, text, color) {
            floatingTexts.push({ x, y, text, color, alpha: 1, life: 60 });
        }

        function toggleMusic() {
            if (music.paused) { music.play(); muteToggle.innerText = "üîà MUTE MUSIC"; }
            else { music.pause(); muteToggle.innerText = "üîä UNMUTE MUSIC"; }
        }

        document.body.addEventListener('mousedown', () => {
            if(music.paused) music.play().catch(()=>{});
        }, {once: true});

        class Ball {
            constructor(x, y, color, isCue = false) {
                this.x = x; this.y = y;
                this.vx = 0; this.vy = 0;
                this.color = color;
                this.isCue = isCue;
                this.inPocket = false;
            }

            draw() {
                if (this.inPocket) return;
                ctx.beginPath();
                ctx.arc(this.x, this.y, BALL_RADIUS, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.shadowBlur = 10; ctx.shadowColor = this.color;
                ctx.fill();
                ctx.shadowBlur = 0;
            }

            update() {
                if (this.inPocket) return;
                this.x += this.vx; this.y += this.vy;
                this.vx *= FRICTION; this.vy *= FRICTION;
                if (Math.abs(this.vx) < MIN_VELOCITY) this.vx = 0;
                if (Math.abs(this.vy) < MIN_VELOCITY) this.vy = 0;

                if (this.x < BALL_RADIUS || this.x > canvas.width - BALL_RADIUS) {
                    this.vx *= -0.8;
                    this.x = this.x < BALL_RADIUS ? BALL_RADIUS : canvas.width - BALL_RADIUS;
                }
                if (this.y < BALL_RADIUS || this.y > canvas.height - BALL_RADIUS) {
                    this.vy *= -0.8;
                    this.y = this.y < BALL_RADIUS ? BALL_RADIUS : canvas.height - BALL_RADIUS;
                }
            }
        }

        function initBalls() {
            balls = [];
            cueBall = new Ball(160, 170, '#ffffff', true);
            balls.push(cueBall);
            const colors = ['#ff007f', '#00f0ff', '#39ff14', '#ffff00', '#ff0000'];
            for(let i=0; i < 5; i++) {
                for(let j=0; j <= i; j++) {
                    balls.push(new Ball(460 + (i * 22), (170 - (i * 11)) + (j * 22), colors[j % colors.length]));
                }
            }
        }

        function checkPockets() {
            balls.forEach(ball => {
                if (ball.inPocket) return;
                pockets.forEach(pocket => {
                    let dx = ball.x - pocket.x;
                    let dy = ball.y - pocket.y;
                    let dist = Math.sqrt(dx*dx + dy*dy);
                    if (dist < POCKET_RADIUS) {
                        ball.inPocket = true;
                        ball.vx = 0; ball.vy = 0;

                        if (ball.isCue) {
                            updateCash(-200);
                            createFloatingText(ball.x, ball.y, "-$200", "#ff0000");
                            setTimeout(() => {
                                ball.inPocket = false;
                                ball.x = 160; ball.y = 170;
                            }, 1000);
                        } else {
                            updateCash(500);
                            createFloatingText(pocket.x, pocket.y, "+$500", "#39ff14");
                        }
                    }
                });
            });
        }

        function checkCollisions() {
            for (let i = 0; i < balls.length; i++) {
                for (let j = i + 1; j < balls.length; j++) {
                    let b1 = balls[i], b2 = balls[j];
                    if (b1.inPocket || b2.inPocket) continue;
                    let dx = b2.x - b1.x, dy = b2.y - b1.y;
                    let dist = Math.sqrt(dx*dx + dy*dy);
                    if (dist < BALL_RADIUS * 2) {
                        let angle = Math.atan2(dy, dx);
                        let overlap = BALL_RADIUS * 2 - dist;
                        b1.x -= Math.cos(angle) * overlap / 2;
                        b1.y -= Math.sin(angle) * overlap / 2;
                        b2.x += Math.cos(angle) * overlap / 2;
                        b2.y += Math.sin(angle) * overlap / 2;
                        let nx = dx / dist, ny = dy / dist;
                        let p = 2 * (b1.vx * nx + b1.vy * ny - b2.vx * nx - b2.vy * ny) / 2;
                        b1.vx -= p * nx; b1.vy -= p * ny;
                        b2.vx += p * nx; b2.vy += p * ny;
                    }
                }
            }
        }

        canvas.onmousedown = () => {
            let moving = balls.some(b => b.vx !== 0 || b.vy !== 0);
            if (!moving) isDragging = true;
        };

        window.onmousemove = (e) => {
            const rect = canvas.getBoundingClientRect();
            mousePos.x = e.clientX - rect.left;
            mousePos.y = e.clientY - rect.top;
        };

        window.onmouseup = () => {
            if (isDragging) {
                let dx = cueBall.x - mousePos.x, dy = cueBall.y - mousePos.y;
                let angle = Math.atan2(dy, dx);
                let dist = Math.sqrt(dx*dx + dy*dy);
                let finalPower = Math.min(dist / 10, 22);
                cueBall.vx = Math.cos(angle) * finalPower;
                cueBall.vy = Math.sin(angle) * finalPower;
                isDragging = false;
                updatePowerUI(0);
            }
        };

        function updatePowerUI(p) {
            const segs = ['seg-green', 'seg-yellow', 'seg-orange', 'seg-red'];
            segs.forEach(s => document.getElementById(s).style.opacity = "0.1");
            if (p > 2) document.getElementById('seg-green').style.opacity = "1";
            if (p > 7) document.getElementById('seg-yellow').style.opacity = "1";
            if (p > 13) document.getElementById('seg-orange').style.opacity = "1";
            if (p > 18) document.getElementById('seg-red').style.opacity = "1";
        }

        function loop() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            pockets.forEach(p => {
                ctx.save();
                ctx.beginPath();
                ctx.arc(p.x, p.y, POCKET_RADIUS, 0, Math.PI*2);
                ctx.shadowBlur = 25; ctx.shadowColor = "#ff007f";
                ctx.fillStyle = "#000"; ctx.fill();
                ctx.strokeStyle = "#ff007f"; ctx.lineWidth = 2; ctx.stroke();
                ctx.restore();
            });

            checkPockets();
            checkCollisions();
            balls.forEach(b => { b.update(); b.draw(); });

            // Floating Text Update
            floatingTexts.forEach((ft, i) => {
                ctx.fillStyle = ft.color;
                ctx.globalAlpha = ft.alpha;
                ctx.font = "bold 16px Roboto Mono";
                ctx.fillText(ft.text, ft.x - 20, ft.y - (60 - ft.life));
                ft.life--;
                ft.alpha -= 0.02;
                if (ft.life <= 0) floatingTexts.splice(i, 1);
            });
            ctx.globalAlpha = 1;

            let moving = balls.some(b => b.vx !== 0 || b.vy !== 0);
            if (!moving && isDragging) {
                let dx = cueBall.x - mousePos.x, dy = cueBall.y - mousePos.y;
                let angle = Math.atan2(dy, dx);
                let dist = Math.min(Math.sqrt(dx*dx + dy*dy), 200);
                updatePowerUI(dist / 10);
                ctx.save();
                ctx.translate(cueBall.x, cueBall.y);
                ctx.rotate(angle + Math.PI);
                ctx.fillStyle = "#8b4513";
                ctx.fillRect(15 + (dist/5), -3, 200, 6);
                ctx.restore();
            }
            requestAnimationFrame(loop);
        }

        function resetTable() {
            let cash = parseInt(balanceDisplay.innerText);
            if(cash >= 200) { balanceDisplay.innerText = cash - 200; initBalls(); }
            else { alert("Not enough cash!"); }
        }

        initBalls();
        loop();
    </script>
</body>
</html>